[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Source separation",
    "section": "",
    "text": "Preface\nThese are notes for the problem of source separation encountered in hyperspectral fiber photometry."
  },
  {
    "objectID": "00_simulations.html#generative-model-for-observed-signal",
    "href": "00_simulations.html#generative-model-for-observed-signal",
    "title": "1  Simulating hyperspectral fiber photometry signals",
    "section": "1.1 Generative model for observed signal",
    "text": "1.1 Generative model for observed signal\n\\[\n\\def\\lexc{\\lambda^{\\dagger}_{j}}\n\\]\n\n\n\n\n\n\n\n\n\nType\nSymbol\nCode\nDescription\n\n\n\n\n\n\\(O_{j}(t,\\lambda)\\)\nO\nobserved signal from the \\(j\\)-th laser at time \\(t\\) at spectral wavelength \\(\\lambda\\)\n\n\nConst\n\\(s_{i}(\\lambda)\\)\nS\nemission spectrum of sensor associated with \\(i\\)-th neuromodulator\n\n\nConst\n\\(e_{j}(\\lambda)\\)\nE\ntime-invariant spectral signature of \\(j\\)-th excitation laser\n\n\nConst\n\\(\\mu_\\textrm{oxy}(\\lambda)\\)\nMu_ox\nSpectrum of oxygenated hemolobin\n\n\nConst\n\\(\\mu_\\textrm{deoxy}(\\lambda)\\)\nMu_dox\nSpectrum of deoxygenated hemolobin\n\n\nParam\n\\(w_{ij}\\)\nW\nemission efficiency of \\(i\\)-th neuromodulator excited by \\(j\\)-th laser\n\n\nParam\n\\(a_{i}(t)\\)\nA\nsensor signal from time varying amount for the \\(i\\)-th neuromodulator\n\n\nParam\n\\(n_{j}(t)\\)\nN\nnoise from \\(j\\)-th laser\n\n\nParam\n\\(b_{j}(\\lambda)\\)\nB\nfiber fluorescence triggered by \\(j\\)-th laser\n\n\nParam\n\\(m(t)\\)\nM\nmotion correction (potentially depends on \\(i\\))\n\n\nParam\n\\(h_\\textrm{oxy}(t)\\)\nH_ox\nHemodynamics (oxygenated component)\n\n\nParam\n\\(h_\\textrm{deoxy}(t)\\)\nH_dox\nHemodynamics (deoxygenated component)\n\n\n\n\\[\n\\begin{align*}\nO_{j}(t,\\lambda)  &= \\{ \\left( \\sum_{i \\in \\{\\textrm{sensors},\\textrm{autofluorescence}\\}}{\\left(a_{i}(t)s_{i}({\\lambda})w_{ij}\\right)} + e_{j}(\\lambda) \\right) &\\\\\n& \\times \\exp \\left[ -\\left[ h_{\\textrm{oxy}}(t)\\mu_{\\textrm{oxy}}(\\lambda)\n+ h_{\\textrm{deoxy}}(t)\\mu_{\\textrm{deoxy}}(\\lambda) \\right]\\right] \\times m(t) &\\\\\n&+ b_{j}(\\lambda) \\} \\times n_{j}(t)\n\\end{align*}\n\\tag{1.1}\\]\n\n\\(a_{i}(t)\\) for \\(i \\in \\textrm{autofluorescence}\\) is slow\n\\(a_{i}(t)\\) for \\(i \\in \\textrm{sensors}\\) can be fast (prior: 50 ms to 1 s) or slow (prior: 10 s to 50 s)\n\\(a_{i}(t) := c_{i}\\{f(t)s_\\textrm{bright}(\\lambda) + (1-f(t))s_\\textrm{dark}(\\lambda)\\}\\) : a single sensor with concentration \\(c_i\\) exists in two states (e.g. bright, dark or bound, unbound) that have their own emission spectra.\nIsosbestic point is the particular \\(\\lambda\\) where the two populations cannot be distinguished. This does not always exist for all sensors, but when it does exist it can be used to infer noise parameters that also corrupt measurements at other \\(\\lambda\\) values.\n\\(n_{j}(t)\\) : laser specific uncorrelated (in time) gaussian noise dominated by high frequency components.\n\\(h_{\\textrm{oxy}}(t), h_{\\textrm{deoxy}}(t)\\) : Blood concentration of hemoglobin in oxygenated or deoxygenated states over time. The fastest dynamics occur at 0.5 Hz\nFor each \\(j\\), a spectral band (around excitation wavelength \\(\\lambda^{\\dagger}_{j}\\) ) has no information because the pixels are saturated. The diffraction pattern around these pixels is dominated by signal from the laser itself. This might provide an approximation for terms like \\(h_{\\textrm{oxy}}(t)\\) … etc. These could be used as inputs to the model.\n\n\\[\nO_{j}(t,\\lexc) = [e_{j}(\\lexc) \\times\\ \\exp[-([\nh_{\\textrm{oxy}}(t)\\mu_{\\textrm{oxy}}(\\lexc)\n+h_{\\textrm{deoxy}}(t)\\mu_{\\textrm{deoxy}}(\\lexc)])] \\times m(t) + b_{j}(\\lexc)] \\times{n_{j}(t)}\n\\]"
  },
  {
    "objectID": "00_simulations.html#model-for-hemodynamics",
    "href": "00_simulations.html#model-for-hemodynamics",
    "title": "1  Simulating hyperspectral fiber photometry signals",
    "section": "1.2 Model for hemodynamics",
    "text": "1.2 Model for hemodynamics\nAbsorption by hemoglobin corrupts the signal. The Beer-Lambert law is used to model this effect in the generative model above.\n\n\\(\\varepsilon\\): extinction coefficient (in \\(\\textrm{cm}^{-1}\\textrm{mole}^{-1}{L}\\)), see Prahl (1998). This is a function of \\(\\lambda\\)\n\\(h\\): concentration (100 to 200 \\(gL^{-1}\\) for Hemoglobin in brain, is a function of time, and linked to brain region-specific neuron activity\n\\(l\\): effective cuvette length in the Beer-Lambert law. We set this to 1 \\(\\textrm{cm}\\), and assume no dependence on \\(\\lambda\\) here.\n\\(M_{\\textrm{Hg}}\\): molar mass of Hemoglobin = 64,500 \\(g\\textrm{mole}^{-1}\\)\n\\(A\\): absorbance, calculated as per Beer-Lambert’s law \\(A = \\frac{\\varepsilon \\times h \\times {l}}{M_{\\textrm{Hg}}}\\)\nLet \\(f(t)\\) be fraction of hemoglobin in the oxygenated state. Define \\(h_{\\textrm{oxy}}\\), \\(h_{\\textrm{deoxy}}\\), \\(\\mu_\\textrm{oxy}\\) and \\(\\mu_\\textrm{deoxy}\\) as:\n\n\\[\n\\begin{align*}\nh_\\textrm{oxy}(t) &= f(t)h_{\\textrm{total}}(t) \\\\\nh_\\textrm{deoxy}(t) &= (1 - f(t))h_{\\textrm{total}}(t) \\\\\n\\mu_\\textrm{oxy} &= \\tfrac{\\varepsilon_{\\textrm{oxy}}(\\lambda)}{M_{\\textrm{Hg}}} \\\\\n\\mu_\\textrm{deoxy} &= \\tfrac{\\varepsilon_{\\textrm{deoxy}}(\\lambda)}{M_{\\textrm{Hg}}}\n\\end{align*}\n\\]\n\nReplacing \\(A\\) in the definition of absorbance: \\(\\frac{I}{I_o} = e^{-A}\\): \\[\nI(\\lambda, t) = I_o(\\lambda, t) e^{-(\\mu_{\\textrm{oxy}}h_{\\textrm{oxy}}(t) + \\mu_{\\textrm{deoxy}}h_{\\textrm{deoxy}}(t))}\n\\]\n\n\n\n\n\nPrahl, Scott. 1998. “Optical Spectra of Hemoglobin.” url: https://omlc.org/spectra/hemoglobin/summary.html."
  },
  {
    "objectID": "01_methods.html#training-a-conv-net",
    "href": "01_methods.html#training-a-conv-net",
    "title": "2  Methods",
    "section": "2.1 Training a conv-net",
    "text": "2.1 Training a conv-net\n\nThe raw signal is simulated with the generative model in Equation 1.1\nA conv-net is trained to reconstruct sensor activity \\(a_{i}(t)\\) for \\(i \\in\\) sensors, and terms describing hemodynamics \\(h_{\\textrm{oxy}}(t), h_{\\textrm{deoxy}}(t)\\) by minimizing mean-squared error at each \\(t\\).\nThe input is organized into n_lasers x n_wavelengths channels for the each fixed time intervals"
  },
  {
    "objectID": "01_methods.html#next-steps",
    "href": "01_methods.html#next-steps",
    "title": "2  Methods",
    "section": "2.2 Next steps",
    "text": "2.2 Next steps\n\nInclude autofluorescence data\nTrain with larger batchsizes/ regularize the model\nUpdates to the loss function/ generative model to incorporate Poisson noise\nCorrelation across laser/wavelengths for generative model suggests high redundancy"
  },
  {
    "objectID": "01_methods.html#generalizing-model-to-real-data",
    "href": "01_methods.html#generalizing-model-to-real-data",
    "title": "2  Methods",
    "section": "2.3 Generalizing model to real data",
    "text": "2.3 Generalizing model to real data\n\nAdversarial training to learn parameters of the generative model\nAutoencoding objective (perhaps some specific channels) for regularization while training and transfer learning (fine tuning for real data)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Prahl, Scott. 1998. “Optical Spectra of Hemoglobin.” url: https://omlc.org/spectra/hemoglobin/summary.html."
  }
]